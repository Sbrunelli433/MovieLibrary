<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Movie Library</title>
    <table id="MovieLibrary"></table>


    <link href="Content/bootstrap.min.css"
          rel="stylesheet" />
    <script src="Scripts/jquery-3.4.1.min.js"
            </script>
    <script src="Scripts/bootstrap.bundle.min.js"
            </script>


    <script src="http://localhost:36354/Scripts/jquery-3.4.1.js"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h2>Steve's Movie Library</h2>
            </div>
        </div>
    </div>
<!--</body>-->

<h5 class="text-danger">
    <b>Note:</b>Please Enter all details correctly and submit
    Here i did not applied validations to this form
</h5>
<div>
    <div class="row">
        <div class="col-sm-6">
            <table id="moviesTable"
                   class="table table-bordered
                   table-condensed table-striped">
                <thead>
                    <tr>
                        <th align="center">Edit</th>
                        <th align="center">Index</th>
                        <th align="center">Movie Title</th>
                        <th align="center">Director's Name</th>
                        <th align="center">Movie Genre</th>
                        <th align="center">Save Changes</th>
                    </tr>
                </thead>
                <tbody id="tb">
                    <tr></tr>
                </tbody>
            </table>
            <div class="form-inline">


                <div class="form-row">
                    <div class="col-sm-6">
                        <button type="button" id="btn"
                                class="btn btn-primary"
                                onclick="addClick();">
                            Get All Movies
                        </button>
                    </div>
                </div>
                <br />
                <div class="form-row">
                    <div class="col-sm-6">
                        <button type="button" id="btnClear"
                                class="btn btn-primary"
                                onclick="btnClear();">
                            Clear Table
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div>
    <div class="row">
        <div class="col-sm-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    Add movie to list by entering the information below
                </div>
                <div class="panel-body">
                    <form name="postform" id="postform" class="form-horizontal">
                        <div class="form-group">
                            <label class="text-info">Movie Title</label>
                            <input type="text" id="movieTitle" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="text-info">Director Name</label>
                            <input type="text" id="directorName" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="text-info">Genre</label>
                            <input type="text" id="genre" class="form-control" />
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <div class="col-sm-6">
                                    <button type="submit" id="submit"
                                            class="btn btn-primary"
                                            onclick="updateClick();">
                                        Submit New Movie
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function updateClick() {
        //Movie = new Object();
        //Movie.Title = $("#movieTitle").val();
        //Movie.DirectorName = $("#directorName").val();
        //Movie.Genre = $("genre").val();
        //if ($("#updateButton").text().trim() == "Add") {

        //}
    }
    function addClick() {

    }
    function btnClear() {

    }
</script>


<script type="text/javascript">

    $(document).ready(function () {
        $("#postform").submit(function (e) {
            e.preventDefault();
            var apiurl = 'http://localhost:36354/api/Movie';
            var data = {
                Title: $("#movieTitle").val().trim(),
                DirectorName: $("#directorName").val().trim(),
                Genre: $("#genre").val().trim(),

            }

            $.ajax({
                url: apiurl,
                type: 'POST',
                dataType: 'json',
                data: data,
                success: function (d) {
                    console.log("yay!", d);
                    alert("Saved Successfully");
                    document.getElementById("postform").reset();
                },
                error: function () {
                    alert("Error, please try again");
                }
            })
        });

        var ulMovies = $('#ulMovies');
        //var moviesTable = $('#moviesTable');
        var tb = $('#tb');

        $('#btn').click(function () {
            $.ajax({
                type: 'GET',
                url: 'api/Movie',
                dataType: 'json',
                success: function (data) {
                    ulMovies.empty();
                    $.each(data, function (index, val) {
                        //var index = val.index;
                        var movie = val.Title;
                        var movieDirector = val.DirectorName;
                        var movieGenre = val.Genre;
                        var movieId = val.Id
                        $("#tb").append("<tr>" +
                            "<td>" +
                            "<button type='button' " +
                            "onclick='#btnEdit'(this);' " +
                            "class='btn btn-default' " +
                            "data-id='" + movieId + "'>" +
                            "<span class='glyphicon glyphicon-edit' />"
                            + "</button>" +
                            "</td >" +
                            "<td display='none' id='movieNumber + @movieId' >" + movieId + "</td>" +
                            "<td>" + movie + "</td>" +
                            "<td>" + movieDirector + "</td>" +
                            "<td>" + movieGenre + "</td>" +
                            "<td>" +
                            "<button type='button' " +
                            "onclick='productDelete(this);' " +
                            "class='btn btn-default'>" +
                            "<span class='glyphicon glyphicon-remove' />" +
                            "</button>" +
                            "</td>" +

                            "</tr>");

                    });

                }
            });
        });

        $("#Save").click(function () {
            $.ajax({
                url: 'http://localhost:36354/api/Movie/' + movieId,
                type: 'PUT',
                dataType: 'application/json',
                data: movie,
                success: function (data, textStatus, xhr) {
                    console.log(data);
                },

            })
        })

        $('#btnEdit').click(function () {

        })

        $('#btnClear').click(function () {
            tb.empty();
            ulMovies.empty();
            //moviesTable.empty();
        });
    });

</script>
<!--</head>

<br />
<body>
    <br />
    <br />-->

    <!--<input id="btn" type="button" value="Get All Movies" />
    <input id="btnEdit" type="button" value="Edit" />
    <input id="Save" type="button" value="Save Data" />
    <input id="btnClear" type="button" value="Clear" />
    <ul id="ulMovies"></ul>-->

</body>
</html>